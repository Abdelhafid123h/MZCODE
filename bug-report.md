# Bug Report: Incorrect Node Type Counts in Graph Metadata
## Problem Statement

The graph_metadata node generated by metazcode contains incorrect node_type_counts that show 0 for all SSIS node types, despite the graph containing the correct data and accurate total node/edge counts.

Environment
Tool: metazcode v1.0
Backend: Memgraph
Command: METAZCODE_DB_BACKEND=memgraph python -m metazcode full --path data/ssis/ssis_northwind
Dataset: SSIS Northwind sample
Expected vs Actual Behavior

### Expected Metadata:
```
{
  "total_nodes": 65,
  "total_edges": 78,
  "node_type_counts": {
    "pipeline": 18,
    "operation": 24, 
    "table": 15,
    "connection": 0,
    "parameter": 0,
    "variable": 0
  }
}
```
Actual Metadata:

{
  "total_nodes": 65,        // ✅ Correct
  "total_edges": 78,        // ✅ Correct  
  "node_type_counts": {
    "pipeline": 0,          // ❌ Should be 18
    "operation": 0,         // ❌ Should be 24
    "table": 0,             // ❌ Should be 15
    "connection": 0,        // ✅ Correct
    "parameter": 0,         // ✅ Correct
    "variable": 0           // ✅ Correct
  }
}

Verification Query
MATCH (n) 
WHERE n.node_type IN ['pipeline', 'operation', 'table'] 
RETURN n.node_type, count(n) 
ORDER BY count(n) DESC
Results: operation: 24, pipeline: 18, table: 15

Additional Issues
analysis_timestamp shows literal "timestamp()" instead of actual timestamp value
Assignment for Maintainer
Primary Task
Fix the metadata generation logic in the analytics-ready optimization module to:

Correctly populate node_type_counts with actual node counts by type
Replace literal "timestamp()" with actual timestamp value
Add validation to ensure metadata counts match live query results
Suggested Implementation
# Pseudo-code for fix
def generate_metadata():
    # Get actual counts
    node_counts = {}
    for node_type in ['pipeline', 'operation', 'table', 'connection', 'parameter', 'variable']:
        count = execute_query(f"MATCH (n {{node_type: '{node_type}'}}) RETURN count(n)")
        node_counts[node_type] = count
    
    # Generate metadata with correct counts
    metadata = {
        "node_type_counts": node_counts,
        "analysis_timestamp": datetime.now().isoformat(),
        # ... other fields
    }
Testing Requirements
Verify metadata counts match live queries after fix
Test with different SSIS datasets
Ensure backward compatibility with existing metadata consumers